// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Summoner {
  id            String               @id
  puuid         String               @unique
  accountId     String
  name          String
  region        String
  profileIconId Int
  summonerLevel Int
  playerMatches PlayerMatchHistory[]

  @@unique([name, region])
}

// Match represents a game played.
model Match {
  gameId        String
  region        String
  gameMode      String
  gameCreatedAt BigInt
  playerStats   PlayerMatchStats[]
  playerMatches PlayerMatchHistory[]

  @@id([region, gameId])
}

// PlayerMatchHistory represents the many-to-many relationship between summoners and matches.
model PlayerMatchHistory {
  puuid String
  region     String
  summoner   Summoner @relation(fields: [puuid], references: [puuid])
  gameId     String
  match      Match    @relation(fields: [region, gameId], references: [region, gameId])

  @@id([puuid, gameId])
}

// PlayerMatchStats contains detailed stats about a player's performance in a specific match.
model PlayerMatchStats {
  region                      String
  gameId                      String
  puuid                       String
  summonerName                String
  item0                       Int
  item1                       Int
  item2                       Int
  item3                       Int
  item4                       Int
  item5                       Int
  item6                       Int
  kills                       Int
  assists                     Int
  deaths                      Int
  championId                  Int
  totalDamageDealtToChampions Int
  totalMinionsKilled          Int
  goldEarned                  Int
  wardsPlaced                 Int
  match                       Match  @relation(fields: [region, gameId], references: [region, gameId])

  @@id([region, gameId, puuid])
}
